<html>
    <link href='https://fonts.googleapis.com/css?family=Comfortaa' rel='stylesheet'>
    <body style="background-color:#0E89EA; overflow: hidden;">
        <!-- <img id="enemy" style="position:absolute; width: 50px; top:300px; left:500px" src="enemy.png">
        <img id="spike" style="position:absolute; width: 25px; top:100px; left:500px" src="spike.png"> -->
        <img id="finish_stick" style="position:absolute; width: 4px; height: 75px; top:500px; left:100px" src="finish1.png">
        <img id="finish_flag" style="position:absolute; height: 27px; top:500px; left:100px" src="finish2.png">
        <img id="floor" style="position:absolute; width: 25px; top:0px; left:0px" src="floor.png">
        <img id="help" style="position:absolute; width: 500px; top:50px; left:500px" src="help.png">
        <img id="player" style="position:absolute; width: 50px; top:50px; left:500px" src="character.png">

        <p id="level" style="font-size: 50px; font-family: 'Comfortaa, Arial';">Level: 1</p>
        <div id="show_stats" style="align-self: right;"><p id="stats" style="font-size: 25px; font-family: 'Comfortaa, Arial';">0, 0</p></div>

    </body>
    <script>
        function getWidth(id){return document.getElementById(id).offsetWidth;}
        function getHeight(id){return document.getElementById(id).offsetHeight;}

        function getLeft(id){return document.getElementById(id).offsetLeft;}
        function getTop(id){return document.getElementById(id).offsetTop;}
        function getRight(id){return ((document.getElementById(id).offsetLeft) + getWidth(id));}
        function getBottom(id){return ((document.getElementById(id).offsetTop) + getHeight(id));}

        function setLeft(id,x){document.getElementById(id).style.left=x+"px";}
        function setTop(id,y){document.getElementById(id).style.top=y+"px";}
        function setRight(id,y){document.getElementById(id).style.top=(y+getWidth(id))+"px";}
        function setBottom(id,y){document.getElementById(id).style.top=(y+getHeight(id))+"px";}

        function addLeft(id,x){setLeft('player', (x+getLeft(id)));}
        function addTop(id,y){setLeft('player', (y+getTop(id)));}
        function addBottom(id,y){setBottom('player', (y+getTop(id)));}
        function addRight(id,y){setRight('player', (y+getLeft(id)));}

        function setWidth(id,x){document.getElementById(id).style.width=x+"px";}
        function setHeight(id,y){document.getElementById(id).style.height=y+"px";}
    
        setTop('floor', (window.innerHeight - 50));
        setWidth('floor', window.innerWidth);
        setHeight('floor', 50);

        setTop('finish_stick', window.innerHeight - 125);
        setLeft('finish_stick', window.innerWidth - 150);

        setTop('finish_flag', window.innerHeight - 80);
        setLeft('finish_flag', window.innerWidth - 146);

        function respawn() {
            spawning = true;
            setTop('player', window.innerHeight - 300);
            setLeft('player', 100)
        }

        var jump_time = 10
        var cooldown = 0
        var jumping = false
        var speed = 5

        var show_stats = false
        var stat_cool_down = -1
        document.getElementById('show_stats').style.display = 'none';

        var level = 1

        respawn();

        var map = {};
        onkeydown = onkeyup = function(e){
            if (!(spawning)) {
                e = e || event;
                map[e.keyCode] = e.type == 'keydown';
            } else {
                map = {};
                jump_time = 0
                cooldown = -10
            }
        }

        // function checkCollision(id1, id2) {
        //     noXOverlap = (getRight(id1) <= getLeft(id2)) || (getLeft(id1) >= getRight(id2));
        //     noYOverlap = (getBottom(id1) <= getTop(id2)) || (getTop(id1) >= getBottom(id2));
        //     if (noXoverlap || noYOverlap) {
        //         return false;
        //     } else {
        //         return true;
        //     }
        // }

        // function checkCollisionList(id1, list) {
        //     collision_list = new ArrayList
        // }

        function gameLoop() {
            if (jump_time <= 0) {
                jumping = false
                cooldown++;
            }
            if (cooldown == 20) {
                jump_time = 10
                cooldown = 0
            }
            
            if (stat_cool_down >= 0) {
                stat_cool_down++;
            }

            if (stat_cool_down == 30) {
                stat_cool_down = -1
            }

            if ((map[87] && map[68]) && (jump_time > 0)) {
                jumping = true
                addLeft('player', speed+1);
            } else if ((map[87] && map[65]) && (jump_time > 0)) {
                jumping = true
                addLeft('player', -speed-1);
            } else if (map[68]) {
                addLeft('player', speed);
            } else if (map[65]) {
                addLeft('player', -speed);
            } else if ((map[87]) && (jump_time > 0)) {
                jumping = true
            } else if (map[81] && (stat_cool_down == -1)) {
                stat_cool_down = 0
                if (show_stats) {
                    document.getElementById('show_stats').style.display = 'none';
                    show_stats = false
                } else {
                    document.getElementById('show_stats').style.display = 'block';
                    show_stats = true
                }
            }

            if (map[83]) {
                document.getElementById('help').style.display = 'block';
            } else {
                document.getElementById('help').style.display = 'none';
            }

            if (jumping ) {
                addTop('player', -15);
                jump_time--;
            }

            if (show_stats) {
                document.getElementById('stats').innerText = (window.innerHeight - getTop('player')) +', '+(getLeft('player')) 
            }
                
            
            
            if ((getTop('player') < (window.innerHeight - 100)) && (!(jumping))) {
                addTop('player', 10);
            }

            if ((getTop('player')) == (window.innerHeight - 100)) {
                spawning = false;
            }
            
            if (getTop('player') > (window.innerHeight - 100)) {
                setTop('player', (window.innerHeight - 100));
            }

            if (getLeft('player') < 0) {
                respawn();
            }

            if (getLeft('player') > window.innerWidth) {
                setLeft('player', window.innerWidth - 20)
            }

            if ((getTop('player') > (window.innerHeight - 125)) && (getLeft('player') > (window.innerWidth - 150))&& (getTop('finish_flag') > (window.innerHeight - 125)) && (map[69])) {
                addTop('finish_flag', -2)
            } else if (getTop('finish_flag') < (window.innerHeight - 80)) {
                addTop('finish_flag', 1)
            }

            setTimeout(gameLoop, 10);
        }
        gameLoop();
    </script>
</html>